from lxml.html import fromstring, tostring
from trafilatura import fetch_url, extract
from constants import data_dir, site_origin

from re import search, sub
from requests import get
import time

asset_type = "spells"
target_dir = data_dir() + asset_type
site_url = site_origin() + asset_type + "/"

def get_file_name(url):
    name_match = search(r'/[0-9]+-([-0-9a-zA-Z]+)$', url)
    name = name_match.group(1)
    print(f'name: {name}.txt')
    return name

def get_file_ext(url):
    ext_match = search(r'\.[^./]+$', url)
    ext = ext_match.group(0)
    return ext

def load_html(url, file_name):
    html = fetch_url(url)
    # with open(target_dir + "/" + file_name + ".orig.html", "w") as html_file:
    #     html_file.write(html)
    root = fromstring(html)
    return root

def get_page_title(root):
    title_el = root.find_class("page-title")[0]
    title = title_el.text_content()
    title = title.strip()
    print(f'title: {title}')
    return title

def download_image(dom_root, file_name):
    image = dom_root.find_class("spell-image")[0]
    image_url = image.get("src")
    if image_url.startswith("//"):
        image_url = "https:" + image_url
    print(f'image: {image_url}')
    res = get(image_url, allow_redirects=True)
    if not res.ok:
        raise Exception(f'{res.status_code} GET {image_url}')
    ext = get_file_ext(image_url)
    with open(target_dir + "/" + file_name + ext, 'wb') as image_file:
        for block in res.iter_content(1024):
            if not block:
                break
            image_file.write(block)

def clean_page(dom_root):
    def remove_el(el):
        el.getparent().remove(el)

    def remove_first(els):
        if len(els) > 0:
            el = els[0]
            el.getparent().remove(el)

    header_el = dom_root.find_class("page-header")
    remove_first(header_el)
    sitebar_el = dom_root.find_class("site-bar")
    remove_first(sitebar_el)
    menu_el = dom_root.get_element_by_id("mega-menu-target")
    remove_el(menu_el)
    comments_el = dom_root.find_class("homebrew-comments")
    remove_first(comments_el)
    footer_el = dom_root.cssselect('footer')
    remove_first(footer_el)

    subtitles_el = dom_root.find_class("mon-stat-block__description-block-heading")
    for subtitle_el in subtitles_el:
        subtitle_el.tag = "h2"

def save_html(dom_root, file_name):
    html = tostring(dom_root,pretty_print=True, method="html",
                    encoding="UTF-8", doctype="<!DOCTYPE html>")
    # with open(target_dir + "/" + file_name + ".new.html", "wb") as html_file:
    #     html_file.write(html)
    return html

def html_to_md(html, file_name, page_title):
    orig_md = extract(html, output_format='markdown', favor_recall=True,
      with_metadata=True, include_images=True, include_formatting=True,
      include_comments=False, include_tables=True, include_links=False)
    md_lines = orig_md.splitlines()

    def fix_metadata_and_header():
        hr_found = False
        i = 0
        end = len(md_lines)
        while i < end:
            line = md_lines[i]
            if line == "---":
                if hr_found:
                    md_lines.insert(i + 1, "")
                    md_lines.insert(i + 2, "# " + page_title)
                    md_lines.insert(i + 3, "")
                    md_lines.insert(i + 4, "![" + page_title + "](" + file_name + ".png)")
                    md_lines.insert(i + 5, "")
                    i = i + 5
                    break
                else:
                    hr_found = True
            else:
                if hr_found:
                    if not (line.startswith("title:") or line.startswith("url:")):
                        del md_lines[i]
                        i = i - 1
            i = i + 1

    def fix_bold_italic_list_prologs():
        for i in range(0, len(md_lines)):
            line = md_lines[i]
            line = sub(r'^\* ([^.]+\.) ([^:]+:)\* ', r'* **\1** *\2* ', line)
            line = sub(r'^\* ([^.]+\.)\* ', r'* **\1** ', line)
            md_lines[i] = line

    fix_bold_italic_list_prologs()
    fix_metadata_and_header()
    md = "\n".join(md_lines)

    with open(target_dir + "/" + file_name + ".txt", "w") as md_file:
        md_file.write(md)

def download_page(slug):
    page_url = site_url + slug
    file_name = get_file_name(page_url)
    dom_root = load_html(page_url, file_name)
    page_title = get_page_title(dom_root)
    download_image(dom_root, file_name)
    clean_page(dom_root)
    new_html = save_html(dom_root, file_name)
    html_to_md(new_html, file_name, page_title)

# accordeons = document.querySelectorAll('[data-type=spells][data-slug]')
# Array.from(accordeons).map(({ dataset }) => dataset.slug)
slugs = [
  "1988-acid-arrow",
  "1989-acid-splash",
  "2618844-acid-splash",
  "1990-aid",
  "2618845-aid",
  "1991-alarm",
  "2619222-alarm",
  "1992-alter-self",
  "2618846-alter-self",
  "1993-animal-friendship",
  "2618847-animal-friendship",
  "1994-animal-messenger",
  "2618850-animal-messenger",
  "1995-animal-shapes",
  "2618851-animal-shapes",
  "1996-animate-dead",
  "2618853-animate-dead",
  "1997-animate-objects",
  "2618855-animate-objects",
  "1998-antilife-shell",
  "2618856-antilife-shell",
  "1999-antimagic-field",
  "2618860-antimagic-field",
  "2000-antipathy-sympathy",
  "2618862-antipathy-sympathy",
  "2001-arcane-eye",
  "2618863-arcane-eye",
  "2002-arcane-hand",
  "2003-arcane-lock",
  "2618868-arcane-lock",
  "2005-arcanists-magic-aura",
  "2006-astral-projection",
  "2618878-astral-projection",
  "2007-augury",
  "2618882-augury",
  "2618884-aura-of-life",
  "2008-awaken",
  "2618897-awaken",
  "2009-bane",
  "2618900-bane",
  "2010-banishment",
  "2618906-banishment",
  "2011-barkskin",
  "2618907-barkskin",
  "2012-beacon-of-hope",
  "2618911-beacon-of-hope",
  "2618832-befuddlement",
  "2013-bestow-curse",
  "2618923-bestow-curse",
  "2618928-bigbys-hand",
  "2014-black-tentacles",
  "2015-blade-barrier",
  "2618929-blade-barrier",
  "2016-bless",
  "2618933-bless",
  "2017-blight",
  "2618934-blight",
  "2018-blindness-deafness",
  "2618938-blindness-deafness",
  "2019-blink",
  "2618939-blink",
  "2020-blur",
  "2618945-blur",
  "2326-branding-smite",
  "2021-burning-hands",
  "2618946-burning-hands",
  "2022-call-lightning",
  "2618949-call-lightning",
  "2023-calm-emotions",
  "2618959-calm-emotions",
  "2024-chain-lightning",
  "2618960-chain-lightning",
  "2618963-charm-monster",
  "2025-charm-person",
  "2618964-charm-person",
  "2026-chill-touch",
  "2618965-chill-touch",
  "2618966-chromatic-orb",
  "2027-circle-of-death",
  "2618969-circle-of-death",
  "2028-clairvoyance",
  "2618972-clairvoyance",
  "2029-clone",
  "2618973-clone",
  "2030-cloudkill",
  "2618976-cloudkill",
  "2031-color-spray",
  "2618978-color-spray",
  "2032-command",
  "2618985-command",
  "2033-commune",
  "2618987-commune",
  "2034-commune-with-nature",
  "2618989-commune-with-nature",
  "2035-comprehend-languages",
  "2618993-comprehend-languages",
  "2036-compulsion",
  "2619041-compulsion",
  "2037-cone-of-cold",
  "2619042-cone-of-cold",
  "2038-confusion",
  "2619043-confusion",
  "2039-conjure-animals",
  "2619044-conjure-animals",
  "2040-conjure-celestial",
  "2619046-conjure-celestial",
  "2041-conjure-elemental",
  "2619047-conjure-elemental",
  "2042-conjure-fey",
  "2619048-conjure-fey",
  "2043-conjure-minor-elementals",
  "2619049-conjure-minor-elementals",
  "2044-conjure-woodland-beings",
  "2619051-conjure-woodland-beings",
  "2045-contact-other-plane",
  "2619052-contact-other-plane",
  "2046-contagion",
  "2619063-contagion",
  "2047-contingency",
  "2619053-contingency",
  "2048-continual-flame",
  "2619065-continual-flame",
  "2049-control-water",
  "2619070-control-water",
  "2050-control-weather",
  "2619054-control-weather",
  "2051-counterspell",
  "2619072-counterspell",
  "2052-create-food-and-water",
  "2619073-create-food-and-water",
  "2053-create-or-destroy-water",
  "2619074-create-or-destroy-water",
  "2054-create-undead",
  "2619076-create-undead",
  "2055-creation",
  "2619077-creation",
  "2056-cure-wounds",
  "2619079-cure-wounds",
  "2057-dancing-lights",
  "2619058-dancing-lights",
  "2058-darkness",
  "2619080-darkness",
  "2059-darkvision",
  "2619082-darkvision",
  "2060-daylight",
  "2619083-daylight",
  "2061-death-ward",
  "2619085-death-ward",
  "2062-delayed-blast-fireball",
  "2619086-delayed-blast-fireball",
  "2063-demiplane",
  "2619088-demiplane",
  "2064-detect-evil-and-good",
  "2619090-detect-evil-and-good",
  "2065-detect-magic",
  "2619097-detect-magic",
  "2066-detect-poison-and-disease",
  "2619093-detect-poison-and-disease",
  "2067-detect-thoughts",
  "2619099-detect-thoughts",
  "2068-dimension-door",
  "2619100-dimension-door",
  "2069-disguise-self",
  "2619102-disguise-self",
  "2070-disintegrate",
  "2619094-disintegrate",
  "2071-dispel-evil-and-good",
  "2619096-dispel-evil-and-good",
  "2072-dispel-magic",
  "2619103-dispel-magic",
  "2619104-dissonant-whispers",
  "2073-divination",
  "2619140-divination",
  "2074-divine-favor",
  "2619142-divine-favor",
  "2618833-divine-smite",
  "2075-divine-word",
  "2619144-divine-word",
  "2076-dominate-beast",
  "2619146-dominate-beast",
  "2077-dominate-monster",
  "2619147-dominate-monster",
  "2078-dominate-person",
  "2619148-dominate-person",
  "2619150-dragons-breath",
  "2619154-drawmijs-instant-summons",
  "2079-dream",
  "2619156-dream",
  "2080-druidcraft",
  "2619158-druidcraft",
  "2081-earthquake",
  "2619160-earthquake",
  "2082-eldritch-blast",
  "2619161-eldritch-blast",
  "2083-enhance-ability",
  "2619165-enhance-ability",
  "2084-enlarge-reduce",
  "2619170-enlarge-reduce",
  "2619172-ensnaring-strike",
  "2085-entangle",
  "2619186-entangle",
  "2086-enthrall",
  "2619192-enthrall",
  "2087-etherealness",
  "2619193-etherealness",
  "2619187-evards-black-tentacles",
  "2088-expeditious-retreat",
  "2619189-expeditious-retreat",
  "2089-eyebite",
  "2619191-eyebite",
  "2090-fabricate",
  "2618848-fabricate",
  "2091-faerie-fire",
  "2618858-faerie-fire",
  "2092-faithful-hound",
  "2093-false-life",
  "2618866-false-life",
  "2094-fear",
  "2618872-fear",
  "2095-feather-fall",
  "2618874-feather-fall",
  "2096-feeblemind",
  "2097-find-familiar",
  "2618877-find-familiar",
  "2098-find-steed",
  "2618879-find-steed",
  "2099-find-the-path",
  "2618881-find-the-path",
  "2100-find-traps",
  "2618883-find-traps",
  "2101-finger-of-death",
  "2618885-finger-of-death",
  "2103-fire-bolt",
  "2618890-fire-bolt",
  "2104-fire-shield",
  "2618894-fire-shield",
  "2105-fire-storm",
  "2618896-fire-storm",
  "2102-fireball",
  "2618887-fireball",
  "2106-flame-blade",
  "2618899-flame-blade",
  "2107-flame-strike",
  "2618920-flame-strike",
  "2108-flaming-sphere",
  "2618919-flaming-sphere",
  "2109-flesh-to-stone",
  "2618905-flesh-to-stone",
  "2110-floating-disk",
  "2111-fly",
  "2618909-fly",
  "2112-fog-cloud",
  "2618910-fog-cloud",
  "2113-forbiddance",
  "2618913-forbiddance",
  "2114-forcecage",
  "2618916-forcecage",
  "2115-foresight",
  "2618918-foresight",
  "2116-freedom-of-movement",
  "2618921-freedom-of-movement",
  "2117-freezing-sphere",
  "2118-gaseous-form",
  "2618927-gaseous-form",
  "2119-gate",
  "2618932-gate",
  "2120-geas",
  "2618940-geas",
  "2121-gentle-repose",
  "2618942-gentle-repose",
  "2122-giant-insect",
  "2618944-giant-insect",
  "2123-glibness",
  "2618948-glibness",
  "2124-globe-of-invulnerability",
  "2618950-globe-of-invulnerability",
  "2125-glyph-of-warding",
  "2618951-glyph-of-warding",
  "2126-goodberry",
  "2618952-goodberry",
  "2127-grease",
  "2618957-grease",
  "2128-greater-invisibility",
  "2618958-greater-invisibility",
  "2129-greater-restoration",
  "2618961-greater-restoration",
  "2130-guardian-of-faith",
  "2619135-guardian-of-faith",
  "2131-guards-and-wards",
  "2618968-guards-and-wards",
  "2132-guidance",
  "2618971-guidance",
  "2133-guiding-bolt",
  "2619136-guiding-bolt",
  "2134-gust-of-wind",
  "2619137-gust-of-wind",
  "2135-hallow",
  "2619138-hallow",
  "2136-hallucinatory-terrain",
  "2619139-hallucinatory-terrain",
  "2137-harm",
  "2618977-harm",
  "2138-haste",
  "2619141-haste",
  "2139-heal",
  "2618979-heal",
  "2140-healing-word",
  "2619143-healing-word",
  "2141-heat-metal",
  "2619145-heat-metal",
  "2142-hellish-rebuke",
  "2619149-hellish-rebuke",
  "2143-heroes-feast",
  "2618983-heroes-feast",
  "2144-heroism",
  "2619151-heroism",
  "2618988-hex",
  "2145-hideous-laughter",
  "2146-hold-monster",
  "2619152-hold-monster",
  "2147-hold-person",
  "2619153-hold-person",
  "2148-holy-aura",
  "2619155-holy-aura",
  "2149-hunters-mark",
  "2619166-hunters-mark",
  "2150-hypnotic-pattern",
  "2619168-hypnotic-pattern",
  "2151-ice-storm",
  "2619178-ice-storm",
  "2152-identify",
  "2619180-identify",
  "2153-illusory-script",
  "2619173-illusory-script",
  "2154-imprisonment",
  "2619175-imprisonment",
  "2155-incendiary-cloud",
  "2619177-incendiary-cloud",
  "2156-inflict-wounds",
  "2619181-inflict-wounds",
  "2157-insect-plague",
  "2619183-insect-plague",
  "2158-instant-summons",
  "2159-invisibility",
  "2619116-invisibility",
  "2161-jump",
  "2618991-jump",
  "2162-knock",
  "2618992-knock",
  "2163-legend-lore",
  "2619010-legend-lore",
  "2619012-leomunds-secret-chest",
  "2619013-leomunds-tiny-hut",
  "2164-lesser-restoration",
  "2619016-lesser-restoration",
  "2165-levitate",
  "2618994-levitate",
  "2166-light",
  "2618996-light",
  "2167-lightning-bolt",
  "2618999-lightning-bolt",
  "2168-locate-animals-or-plants",
  "2619000-locate-animals-or-plants",
  "2169-locate-creature",
  "2619001-locate-creature",
  "2170-locate-object",
  "2619002-locate-object",
  "2171-longstrider",
  "2619004-longstrider",
  "2172-mage-armor",
  "2619006-mage-armor",
  "2173-mage-hand",
  "2619008-mage-hand",
  "2174-magic-circle",
  "2619018-magic-circle",
  "2175-magic-jar",
  "2619021-magic-jar",
  "2176-magic-missile",
  "2619022-magic-missile",
  "2177-magic-mouth",
  "2619023-magic-mouth",
  "2178-magic-weapon",
  "2619024-magic-weapon",
  "2179-magnificent-mansion",
  "2180-major-image",
  "2619025-major-image",
  "2181-mass-cure-wounds",
  "2619026-mass-cure-wounds",
  "2182-mass-heal",
  "2619027-mass-heal",
  "2183-mass-healing-word",
  "2619028-mass-healing-word",
  "2184-mass-suggestion",
  "2619029-mass-suggestion",
  "2185-maze",
  "2619030-maze",
  "2186-meld-into-stone",
  "2619031-meld-into-stone",
  "2619032-melfs-acid-arrow",
  "2187-mending",
  "2619033-mending",
  "2188-message",
  "2619034-message",
  "2189-meteor-swarm",
  "2619035-meteor-swarm",
  "2190-mind-blank",
  "2619036-mind-blank",
  "2191-minor-illusion",
  "2619039-minor-illusion",
  "2192-mirage-arcane",
  "2619040-mirage-arcane",
  "2193-mirror-image",
  "2619060-mirror-image",
  "2194-mislead",
  "2619131-mislead",
  "2195-misty-step",
  "2619133-misty-step",
  "2196-modify-memory",
  "2619109-modify-memory",
  "2197-moonbeam",
  "2619134-moonbeam",
  "2619110-mordenkainens-faithful-hound",
  "2619112-mordenkainens-magnificent-mansion",
  "2619114-mordenkainens-private-sanctum",
  "2004-mordenkainens-sword",
  "2619118-mordenkainens-sword",
  "2198-move-earth",
  "2619120-move-earth",
  "2199-nondetection",
  "2619122-nondetection",
  "2619124-nystuls-magic-aura",
  "2619126-otilukes-freezing-sphere",
  "2619128-otilukes-resilient-sphere",
  "2160-ottos-irresistible-dance",
  "2619130-ottos-irresistible-dance",
  "2201-pass-without-trace",
  "2618849-pass-without-trace",
  "2200-passwall",
  "2618852-passwall",
  "2202-phantasmal-killer",
  "2618857-phantasmal-killer",
  "2203-phantom-steed",
  "2618859-phantom-steed",
  "2204-planar-ally",
  "2618861-planar-ally",
  "2205-planar-binding",
  "2618864-planar-binding",
  "2206-plane-shift",
  "2618867-plane-shift",
  "2207-plant-growth",
  "2618869-plant-growth",
  "2208-poison-spray",
  "2618875-poison-spray",
  "2209-polymorph",
  "2618876-polymorph",
  "2618880-power-word-heal",
  "2210-power-word-kill",
  "2618886-power-word-kill",
  "2211-power-word-stun",
  "2618889-power-word-stun",
  "2212-prayer-of-healing",
  "2618892-prayer-of-healing",
  "2213-prestidigitation",
  "2618893-prestidigitation",
  "2214-prismatic-spray",
  "2618895-prismatic-spray",
  "2215-prismatic-wall",
  "2618898-prismatic-wall",
  "2216-private-sanctum",
  "2217-produce-flame",
  "2618901-produce-flame",
  "2218-programmed-illusion",
  "2618902-programmed-illusion",
  "2219-project-image",
  "2618903-project-image",
  "2220-protection-from-energy",
  "2618908-protection-from-energy",
  "2221-protection-from-evil-and-good",
  "2618912-protection-from-evil-and-good",
  "2222-protection-from-poison",
  "2618915-protection-from-poison",
  "2223-purify-food-and-drink",
  "2618917-purify-food-and-drink",
  "2224-raise-dead",
  "2618922-raise-dead",
  "2618925-rarys-telepathic-bond",
  "2225-ray-of-enfeeblement",
  "2618926-ray-of-enfeeblement",
  "2226-ray-of-frost",
  "2618930-ray-of-frost",
  "2618935-ray-of-sickness",
  "2227-regenerate",
  "2618937-regenerate",
  "2228-reincarnate",
  "2618941-reincarnate",
  "2229-remove-curse",
  "2618943-remove-curse",
  "2230-resilient-sphere",
  "2231-resistance",
  "2618947-resistance",
  "2232-resurrection",
  "2618953-resurrection",
  "2233-reverse-gravity",
  "2618954-reverse-gravity",
  "2234-revivify",
  "2618956-revivify",
  "2235-rope-trick",
  "2618962-rope-trick",
  "2236-sacred-flame",
  "2618967-sacred-flame",
  "2237-sanctuary",
  "2619003-sanctuary",
  "2238-scorching-ray",
  "2619005-scorching-ray",
  "2239-scrying",
  "2619007-scrying",
  "2619009-searing-smite",
  "2240-secret-chest",
  "2242-see-invisibility",
  "2619011-see-invisibility",
  "2241-seeming",
  "2619014-seeming",
  "2243-sending",
  "2619015-sending",
  "2244-sequester",
  "2618980-sequester",
  "2245-shapechange",
  "2618982-shapechange",
  "2246-shatter",
  "2619017-shatter",
  "2247-shield",
  "2619019-shield",
  "2248-shield-of-faith",
  "2619020-shield-of-faith",
  "2249-shillelagh",
  "2618984-shillelagh",
  "2618838-shining-smite",
  "2250-shocking-grasp",
  "2618986-shocking-grasp",
  "2251-silence",
  "2619061-silence",
  "2252-silent-image",
  "2619062-silent-image",
  "2253-simulacrum",
  "2618995-simulacrum",
  "2254-sleep",
  "2619064-sleep",
  "2255-sleet-storm",
  "2618998-sleet-storm",
  "2256-slow",
  "2619066-slow",
  "2618839-sorcerous-burst",
  "2257-spare-the-dying",
  "2619067-spare-the-dying",
  "2258-speak-with-animals",
  "2619059-speak-with-animals",
  "2259-speak-with-dead",
  "2619068-speak-with-dead",
  "2260-speak-with-plants",
  "2619069-speak-with-plants",
  "2261-spider-climb",
  "2619071-spider-climb",
  "2262-spike-growth",
  "2619075-spike-growth",
  "2264-spirit-guardians",
  "2619078-spirit-guardians",
  "2263-spiritual-weapon",
  "2619081-spiritual-weapon",
  "2618840-starry-wisp",
  "2265-stinking-cloud",
  "2619091-stinking-cloud",
  "2267-stone-shape",
  "2619092-stone-shape",
  "2266-stoneskin",
  "2619095-stoneskin",
  "2268-storm-of-vengeance",
  "2619098-storm-of-vengeance",
  "2269-suggestion",
  "2619101-suggestion",
  "2618843-summon-dragon",
  "2270-sunbeam",
  "2619121-sunbeam",
  "2271-sunburst",
  "2619123-sunburst",
  "2272-symbol",
  "2619127-symbol",
  "2619132-tashas-hideous-laughter",
  "2273-telekinesis",
  "2619157-telekinesis",
  "2274-telepathic-bond",
  "2275-teleport",
  "2619163-teleport",
  "2276-teleportation-circle",
  "2619167-teleportation-circle",
  "2619169-tensers-floating-disk",
  "2277-thaumaturgy",
  "2619174-thaumaturgy",
  "2278-thunderwave",
  "2619184-thunderwave",
  "2279-time-stop",
  "2619185-time-stop",
  "2280-tiny-hut",
  "2281-tongues",
  "2619190-tongues",
  "2282-transport-via-plants",
  "2619196-transport-via-plants",
  "2283-tree-stride",
  "2619197-tree-stride",
  "2284-true-polymorph",
  "2619198-true-polymorph",
  "2285-true-resurrection",
  "2619199-true-resurrection",
  "2286-true-seeing",
  "2619201-true-seeing",
  "2287-true-strike",
  "2619204-true-strike",
  "2288-unseen-servant",
  "2619209-unseen-servant",
  "2289-vampiric-touch",
  "2619214-vampiric-touch",
  "2290-vicious-mockery",
  "2619216-vicious-mockery",
  "2291-wall-of-fire",
  "2619107-wall-of-fire",
  "2292-wall-of-force",
  "2619194-wall-of-force",
  "2293-wall-of-ice",
  "2619195-wall-of-ice",
  "2294-wall-of-stone",
  "2619200-wall-of-stone",
  "2295-wall-of-thorns",
  "2619202-wall-of-thorns",
  "2296-warding-bond",
  "2619203-warding-bond",
  "2297-water-breathing",
  "2619205-water-breathing",
  "2298-water-walk",
  "2619207-water-walk",
  "2299-web",
  "2619208-web",
  "2300-weird",
  "2619210-weird",
  "2301-wind-walk",
  "2619211-wind-walk",
  "2302-wind-wall",
  "2619212-wind-wall",
  "2303-wish",
  "2619213-wish",
  "2304-word-of-recall",
  "2619218-word-of-recall",
  "2305-zone-of-truth",
  "2619221-zone-of-truth"
]

for slug in slugs:
    download_page(slug)
    time.sleep(3)
